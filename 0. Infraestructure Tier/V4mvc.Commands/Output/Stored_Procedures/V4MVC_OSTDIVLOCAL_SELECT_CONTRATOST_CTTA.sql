CREATE PROCEDURE [dbo].[V4MVC_OSTDIVLOCAL_SELECT_CONTRATOST_CTTA]
(
 @NROOST		NVARCHAR(14)
) AS
BEGIN
	SELECT
		ODL.DIVISION,
		ODL.ADMINOST,
		ODL.ADMINCONTR,
		COALESCE(
			(
			  SELECT TOP 1 CONCAT(W1.NOMBRES, ' ', W1.APELLIDOS)
			  FROM WORKERS W1
			  WHERE W1.RUT = ODL.ADMINOST
			)
		, '') AS NOMBRES_ADMINOST,
		COALESCE(
			(
			  SELECT TOP 1 CONCAT(W2.NOMBRES, ' ', W2.APELLIDOS)
			  FROM WORKERS W2
			  WHERE W2.RUT = ODL.ADMINCONTR
			)
		, '') AS NOMBRES_ADMINCONTR
	FROM OSTDIVLOCAL ODL
	WHERE ODL.OST = @NROOST
END

