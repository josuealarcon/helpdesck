CREATE PROCEDURE [dbo].[V4MVC_COMBOOST_CASCADA_SELECT_ACREDITACIONVEHICULARCTTA]
(
@EMPRESA  NVARCHAR(10) = NULL,
@DIVISION  NVARCHAR(10) = NULL
) AS
BEGIN
DECLARE @strSQL as nvarchar(MAX)
SET @strSQL='SELECT DISTINCT O.NROOST, OD.DIVISION 	FROM OST O 	INNER JOIN OSTDIVLOCAL OD ON O.NROOST = OD.OST 	
                                                    INNER JOIN OSTARBOL OA ON O.NROOST = OA.OST 	
WHERE O.FECTERM > getdate()	
AND OA.FTERMINO > getdate()'
IF @DIVISION='Ambas'
BEGIN
Set @strSQL = @strSQL + N' AND OD.DIVISION IN (''LB'',''LT'')'
END
ELSE
BEGIN
Set @strSQL = @strSQL + N' AND OD.DIVISION IN (''' + @DIVISION + ''')'
END
Set @strSQL = @strSQL + N' AND OA.EMPRESA = ''' + @EMPRESA + ''''
exec sp_executesql @strSQL  
END
