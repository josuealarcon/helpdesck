CREATE PROCEDURE [dbo].[V4MVC_SELECT_ROL_CTTA]
(
  @IDISPLAYSTART	 INT           
 ,@IDISPLAYLENGTH	 INT
 ,@SEARCH_ID_ROL	 NVARCHAR(8) = ''
 ,@SEARCH_ROL		 NVARCHAR(200) = ''
 ,@SORT_COLUMN		 NVARCHAR(4) = NULL  
 ,@SORT_DIRECTION	 NVARCHAR(4) = NULL
 ,@TOTAL_COUNT		 INT OUTPUT
)
AS
BEGIN
	DECLARE @ID_ROL INT = 0

	IF(@SORT_DIRECTION = 'ASC')
		BEGIN
			IF((@SEARCH_ID_ROL IS NULL OR @SEARCH_ID_ROL = '') AND (@SEARCH_ROL IS NULL OR @SEARCH_ROL = ''))
				BEGIN
					SELECT
						@TOTAL_COUNT = COUNT(*)
					FROM ROL

					SELECT
						ID_ROL,
						ROL
					FROM ROL
					ORDER BY 
						CASE WHEN @SORT_COLUMN = '0' THEN ID_ROL END ASC,
						CASE WHEN @SORT_COLUMN = '1' THEN ROL END ASC
					OFFSET @IDISPLAYSTART ROWS FETCH NEXT @IDISPLAYLENGTH ROWS ONLY
				END
			ELSE IF (@SEARCH_ID_ROL IS NOT NULL AND @SEARCH_ID_ROL <> '')
				BEGIN
					IF(ISNUMERIC(@SEARCH_ID_ROL) = 1)
						BEGIN
							SET @ID_ROL = CONVERT(INT, @SEARCH_ID_ROL)
						END

					SELECT
						@TOTAL_COUNT = COUNT(*)
					FROM ROL 
					WHERE ID_ROL = @ID_ROL

					SELECT
						ID_ROL,
						ROL
					FROM ROL 
					WHERE ID_ROL = @ID_ROL
					ORDER BY 
						CASE WHEN @SORT_COLUMN = '0' THEN ID_ROL END ASC,
						CASE WHEN @SORT_COLUMN = '1' THEN ROL END ASC
					OFFSET @IDISPLAYSTART ROWS FETCH NEXT @IDISPLAYLENGTH ROWS ONLY
				END
			ELSE IF (@SEARCH_ROL IS NOT NULL AND @SEARCH_ROL <> '')
				BEGIN
					SELECT
						@TOTAL_COUNT = COUNT(*)
					FROM ROL
					WHERE ROL LIKE CONCAT('%', @SEARCH_ROL, '%')

					SELECT
						ID_ROL,
						ROL
					FROM ROL
					WHERE ROL LIKE CONCAT('%', @SEARCH_ROL, '%')
					ORDER BY 
						CASE WHEN @SORT_COLUMN = '0' THEN ID_ROL END ASC,
						CASE WHEN @SORT_COLUMN = '1' THEN ROL END ASC
					OFFSET @IDISPLAYSTART ROWS FETCH NEXT @IDISPLAYLENGTH ROWS ONLY
				END
		END
	ELSE
		BEGIN
			IF((@SEARCH_ID_ROL IS NULL OR @SEARCH_ID_ROL = '') AND (@SEARCH_ROL IS NULL OR @SEARCH_ROL = ''))
				BEGIN
					SELECT
						@TOTAL_COUNT = COUNT(*)
					FROM ROL

					SELECT
						ID_ROL,
						ROL
					FROM ROL
					ORDER BY 
						CASE WHEN @SORT_COLUMN = '0' THEN ID_ROL END DESC,
						CASE WHEN @SORT_COLUMN = '1' THEN ROL END DESC
					OFFSET @IDISPLAYSTART ROWS FETCH NEXT @IDISPLAYLENGTH ROWS ONLY
				END
			ELSE IF (@SEARCH_ID_ROL IS NOT NULL AND @SEARCH_ID_ROL <> '')
				BEGIN
					IF(ISNUMERIC(@SEARCH_ID_ROL) = 1)
						BEGIN
							SET @ID_ROL = CONVERT(INT, @SEARCH_ID_ROL)
						END

					SELECT
						@TOTAL_COUNT = COUNT(*)
					FROM ROL 
					WHERE ID_ROL = @ID_ROL

					SELECT
						ID_ROL,
						ROL
					FROM ROL 
					WHERE ID_ROL = @ID_ROL
					ORDER BY 
						CASE WHEN @SORT_COLUMN = '0' THEN ID_ROL END DESC,
						CASE WHEN @SORT_COLUMN = '1' THEN ROL END DESC
					OFFSET @IDISPLAYSTART ROWS FETCH NEXT @IDISPLAYLENGTH ROWS ONLY
				END
			ELSE IF (@SEARCH_ROL IS NOT NULL AND @SEARCH_ROL <> '')
				BEGIN
					SELECT
						@TOTAL_COUNT = COUNT(*)
					FROM ROL
					WHERE ROL LIKE CONCAT('%', @SEARCH_ROL, '%')

					SELECT
						ID_ROL,
						ROL
					FROM ROL
					WHERE ROL LIKE CONCAT('%', @SEARCH_ROL, '%')
					ORDER BY 
						CASE WHEN @SORT_COLUMN = '0' THEN ID_ROL END DESC,
						CASE WHEN @SORT_COLUMN = '1' THEN ROL END DESC
					OFFSET @IDISPLAYSTART ROWS FETCH NEXT @IDISPLAYLENGTH ROWS ONLY
				END
		END

END
