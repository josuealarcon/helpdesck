CREATE PROCEDURE [dbo].[V4MVC__F29_UPDATE_CONTROLLABORAL_CTTA]
(
  @PERIODO			NVARCHAR(6)
 ,@IDEMPRESA		NVARCHAR(10)
 ,@VENTAS			BIGINT
 ,@COMPRAS			BIGINT
 ,@PPM				BIGINT
 ,@REMANENTE		BIGINT
 ,@IRENTA			BIGINT
 ,@BHONORARIOS		BIGINT
 ,@IMP_PAGADO		BIGINT
 ,@REMMESANT		BIGINT
 ,@MULTAS			BIGINT
 ,@ESTADOCERT		NVARCHAR(20)
 ,@RET_CODE			INT OUTPUT
) AS
BEGIN
	SET @RET_CODE = -1
	IF(NOT EXISTS(
			SELECT
				PERIODO
			FROM _F29
			WHERE
				EMPRESA = @IDEMPRESA AND
				PERIODO = @PERIODO
	))
		BEGIN
			SET @RET_CODE = 2  /*ERROR LOGICO; NO EXISTE*/
			RETURN
		END
	UPDATE _F29
	SET
		VENTAS = @VENTAS,
		COMPRAS = @COMPRAS,
		PPM = @PPM,
		REMANENTE = @REMANENTE,
		IRENTA = @IRENTA,
		BHONORARIOS = @BHONORARIOS,
		IMP_PAGADO = @IMP_PAGADO,
		REMMESANT = @REMMESANT,
		MULTAS = @MULTAS,
		ESTADOCERT = @ESTADOCERT
	WHERE
		EMPRESA = @IDEMPRESA AND
		PERIODO = @PERIODO
END
