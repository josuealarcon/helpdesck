CREATE PROCEDURE [dbo].[V4MVC_CERT_TASAS_UPDATE_CONTROLLABORAL_CTTA]
(
  @PERIODO				NVARCHAR(6)
 ,@IDEMPRESA			NVARCHAR(10)
 ,@FOLIO				BIGINT
 ,@NRO_ACCIDENTES		INT
 ,@DIAS_ACCIDENTES		INT
 ,@DIAS_ENFERMEDAD		INT
 ,@NRO_ENFERMEDAD		INT
 ,@DIAS_INCAPACIDAD		INT
 ,@DIAS_FATALES			INT
 ,@TOTAL_PERDIDOS		INT
 ,@RET_CODE				INT OUTPUT
) AS
BEGIN

	SET @RET_CODE = -1
	
	IF(NOT EXISTS(
			SELECT
				PERIODO
			FROM CERT_TASAS
			WHERE
				EMPRESA = @IDEMPRESA AND
				PERIODO = @PERIODO
	))
		BEGIN
			SET @RET_CODE = 2  /*ERROR LOGICO; NO EXISTE*/
			RETURN
		END

		UPDATE CERT_TASAS
		SET
			FOLIO = @FOLIO,
			NRO_ACCIDENTES = @NRO_ACCIDENTES,
			DIAS_ACCIDENTES = @DIAS_ACCIDENTES,
			DIAS_ENFERMEDAD = @DIAS_ENFERMEDAD,
			NRO_ENFERMEDAD = @NRO_ENFERMEDAD,
			DIAS_INCAPACIDAD = @DIAS_INCAPACIDAD,
			DIAS_FATALES = @DIAS_FATALES,
			TOTAL_PERDIDOS = @TOTAL_PERDIDOS
		WHERE
			EMPRESA = @IDEMPRESA AND
			PERIODO = @PERIODO
END
