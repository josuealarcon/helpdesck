CREATE PROCEDURE [dbo].[V4MVC_WORKERS_LICENCIAS_UPDATE_CONDUCTORES_CTTA]
(@RUT			NVARCHAR(10)
,@LICENCIAS		NVARCHAR(200))AS
BEGIN
	DELETE FROM WORKERS_LICENCIAS WHERE (RUT = @RUT)
	
	SET @LICENCIAS = @LICENCIAS  + ','
	DECLARE @POSICION INT = 0
	DECLARE @LONGITUD INT = 0
	DECLARE @LICENCIA nvarchar(10)

	WHILE CHARINDEX(',', @LICENCIAS, @POSICION + 1 )>0
	BEGIN
		SET @LONGITUD = CHARINDEX(',', @LICENCIAS, @POSICION + 1 ) - @POSICION
		SET @LICENCIA = SUBSTRING(@LICENCIAS, @POSICION, @LONGITUD)
           
		INSERT INTO WORKERS_LICENCIAS (RUT, LICENCIAS) VALUES (@RUT,@LICENCIA)

		SET @POSICION = CHARINDEX(',', @LICENCIAS, @POSICION + @LONGITUD) +1
	END

END

