CREATE  PROCEDURE [dbo].[V4MVC_WORKERS_INSERT_APROBACION_SUBCONTRATOS_CTTA]  
(  
 @RUT			NVARCHAR(10) = NULL 
,@NOMBRES		NVARCHAR(50) = NULL 
,@APELLIDOS		NVARCHAR(50) = NULL 
,@EMAIL			NVARCHAR(100)= NULL  
,@CELULAR		NVARCHAR(20) = NULL
,@EMPRESA		NVARCHAR(20) = NULL
)  
AS  
BEGIN  

DECLARE @EXISTE INT

	SELECT @EXISTE= count(1) FROM WORKERS 
	WHERE RUT = @RUT 

	IF  (@EXISTE = 0) 
	BEGIN
		INSERT INTO WORKERS (RUT ,NOMBRES ,APELLIDOS  ,EMAIL)   
		VALUES    (@RUT ,@NOMBRES ,@APELLIDOS  ,@EMAIL)
		;

		INSERT INTO DIRECCION (RUT,CELULAR)
		VALUES(@RUT,@CELULAR)
	END
	ELSE
	BEGIN
		UPDATE WORKERS
		SET  NOMBRES= @NOMBRES
		,APELLIDOS= @APELLIDOS
		,EMPRESA = @EMPRESA
		,AUTOR = 'NO'
		,EMAIL = @EMAIL
		WHERE RUT = @RUT

		UPDATE DIRECCION
		SET CELULAR = @CELULAR
		WHERE RUT = @RUT 
	END
END  
