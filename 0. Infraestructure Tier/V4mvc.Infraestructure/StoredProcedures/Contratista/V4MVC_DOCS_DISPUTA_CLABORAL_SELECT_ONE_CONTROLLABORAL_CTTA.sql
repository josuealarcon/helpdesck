CREATE PROCEDURE [dbo].[V4MVC_DOCS_DISPUTA_CLABORAL_SELECT_ONE_CONTROLLABORAL_CTTA]
(
  @DISPUTA_ID	INT
) AS
BEGIN
	SELECT
		TOP 1
		DD.USUARIO,
		DD.FECHA,
		DD.HORA,
		DD.CERTUSUARIO,
		DD.CERTFECHA,
		DD.CERTHORA,
		DD.REVALUSUARIO,
		DD.REVALFECHA,
		DD.REVALHORA,
		DD.EMPRESA,
		DD.DIVISION,
		DD.OST,
		DD.PERIODO,
		DD.ID,
		DD.OBSERVACION,
		DD.VALIDADO,
		DD.ESTADO,
		DD.OBSERVACION_REVAL,
		DD.ID_DOC,
		DD.ID_CERTIFICADO,
		E.ACRONIMO,
		D.NOMBRE,
		DD.ID_DISPUTA,
		[dbo].[V4MVC_FSTR_RUT](E.IDEMPRESA) AS STRUT_EMPRESA,
		COALESCE(
					(
						SELECT
							TOP 1
							CONCAT(NOMBRES, ' ', APELLIDOS)
						FROM WORKERS
						WHERE RUT = DD.USUARIO
					), ''
				) AS NOMBRE_USUARIO
	FROM DOCS_DISPUTA_CLABORAL DD
	INNER JOIN DOCS D
		ON D.ID_DOC = DD.ID_DOC
	INNER JOIN ENTERPRISE E
		ON E.IDEMPRESA = DD.EMPRESA
	WHERE DD.ID_DISPUTA = @DISPUTA_ID
END
