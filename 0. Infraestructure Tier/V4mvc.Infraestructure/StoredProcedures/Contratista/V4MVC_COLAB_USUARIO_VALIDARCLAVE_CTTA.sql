CREATE PROCEDURE [dbo].[V4MVC_COLAB_USUARIO_VALIDARCLAVE_CTTA]
(
 @ID			NVARCHAR(10)
,@IDEMPRESA		NVARCHAR(11)
,@CLAVE			NVARCHAR(20)
)
AS
BEGIN

		IF EXISTS(SELECT		Rut		,IdEmpresa
					FROM		COLAB_USUARIO 
					WHERE		IDEMPRESA		=		@IDEMPRESA
					AND			RUT				=		@ID
					AND		   (CLAVE = @CLAVE OR CLAVE = SUBSTRING(master.dbo.fn_varbintohexstr(HashBytes('SHA1', convert(nvarchar(50),@CLAVE))), 3, 32)))
			BEGIN
				SELECT 1 AS RESPUESTA
			END
		ELSE
			BEGIN
				SELECT 0 AS RESPUESTA
			END
END
