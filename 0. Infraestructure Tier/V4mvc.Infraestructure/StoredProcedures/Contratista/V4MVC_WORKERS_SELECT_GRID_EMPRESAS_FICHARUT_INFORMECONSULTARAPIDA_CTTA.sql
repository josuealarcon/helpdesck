CREATE PROCEDURE [dbo].[V4MVC_WORKERS_SELECT_GRID_EMPRESAS_FICHARUT_INFORMECONSULTARAPIDA_CTTA]
(
  @RUT	NVARCHAR(10)
) AS 
BEGIN


SELECT	 W.RUT				, D.DIVISION			, D.DIVCOD			, W.EMPRESA, 
		 W.TIPOPASE			, W.FINIPASE			, W.FFINPASE		, W.LOTE, 
		 E.ACRONIMO			, W.OST					, W.AUTOR			, W.QUIEN, 
		 W.FECHAMOD			, W.HORAMOD				, VALIDADO          , dbo.fn_WL_Conductor(W.RUT, W.DIVISION, dbo.hoy(GETDATE())) AS CONDUCTOR, 
		 dbo.[fn_WL_Certificado] (W.RUT, W.EMPRESA , W.TIPOPASE, D.DIVCOD, dbo.hoy(getdate())) AS CERT
FROM WORKERSLOCAL as W, ENTERPRISE AS E, A024_DIVISIONES as D 
WHERE  (W.FFINPASE >=  dbo.hoy(GETDATE()) ) AND (W.RUT = @RUT) AND (W.EMPRESA = E.IDEMPRESA) AND (D.DIVCOD = W.DIVISION) 
ORDER BY E.ACRONIMO ASC, D.DIVISION, W.LOTE DESC, W.FINIPASE

END
