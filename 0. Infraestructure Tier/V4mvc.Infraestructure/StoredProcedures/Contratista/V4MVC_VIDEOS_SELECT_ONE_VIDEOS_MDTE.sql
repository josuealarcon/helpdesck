CREATE PROCEDURE [dbo].[V4MVC_VIDEOS_SELECT_ONE_VIDEOS_MDTE]
(
  @ID_VIDEO  NVARCHAR(18)
)
AS
BEGIN
	SELECT
		TOP 1
		V.ID,
		V.MODULO_V4 AS MODULO_V4,
		V.DESCRIPCION AS DESCRIPCION,
		V.VERSION AS VERSION,
		V.PRIVADO AS PRIVADO,
		V.USUARIO AS USUARIO,
		COALESCE((SELECT TOP 1 CONCAT(W.NOMBRES, ' ', W.APELLIDOS) FROM WORKERS W WHERE W.RUT = V.USUARIO), '') AS USUARIO_NOMBRES,
		COALESCE((SELECT TOP 1 L.LINK FROM LINKS_VIDEOS_V4 L WHERE L.ID_VIDEO = CONVERT(INT, V.ID)), '') AS VISTA_LINK
	FROM VIDEOS V
	WHERE V.ID = CONVERT(NUMERIC(18,0), @ID_VIDEO)
END
