CREATE PROCEDURE [dbo].[V4MVC_OST_SELECT_V2_CONTROLLABORAL_CTTA]
(
  @IDEMPRESA	NVARCHAR(10)
 ,@DIVISION		NVARCHAR(10)
) AS
BEGIN
	SELECT
		DISTINCT
			DL.OST AS OOST,
			OSC.FINICIO AS FECINICIO,
			OSC.FTERMINO AS FECTERM,
			OST.DESCRIPOST
	FROM OSTDIVLOCAL DL
	INNER JOIN OSTSUBC OSC
		ON DL.OST = OSC.OST AND ((DL.EMPRESA = OSC.EMPRESA) OR (DL.EMPRESA = OSC.MADRE))
	INNER JOIN OST
		ON OSC.OST = dbo.OST.NROOST AND ((OSC.EMPRESA = OST.IDEMPRESA) OR (OSC.MADRE = OST.IDEMPRESA))
	WHERE
		(DL.DIVISION = @DIVISION) AND
		(DL.ACTIVO = 'SI') AND
		(OSC.EMPRESA = @IDEMPRESA)
	ORDER BY DL.OST DESC
END
